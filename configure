#!/bin/bash
FIRST=I0NvbXBpbGVyIHRvIGJlIHVzZWQKQ0MgOj0gZ2NjCgojRGlyZWN0b3JpZXMKVEFSR0VURElSIDo9IGJpbgpCVUlMRERJUiA6PSBidWlsZApJTkNMVURFRElSIDo9IGluY2x1ZGUKU1JDRElSIDo9IHNyYwoKI0ZpbGUgRXh0ZW5zaW9ucwpTUkNFWFQgOj0gYwpPQkpFWFQgOj0gbwoKI0NvbXBpbGVyIGFyZ3VtZW50cwpDRkxBR1MgOj0gLWcgLVdhbGwgLVdlcnJvcgpMSUIgOj0gCklOQyA6PSAtSSAkKElOQ0xVREVESVIpCgojRXhlY3V0YWJsZXMgdG8gYmUgYnVpbHQK

SECOND=CiNCdWlsZHMgYWxsIHRhcmdldHMKYWxsOiAkKFRBUkdFVFMpCgojQ29tcGlsZXMgaW5kaXZpZHVhbCBvYmplY3QgZmlsZXMKJChCVUlMRERJUikvJS4kKE9CSkVYVCk6ICQoU1JDRElSKS8lLiQoU1JDRVhUKQoJQGVjaG8gIkNvbXBpbGluZyAkPCIKCUBta2RpciAtcCAkKEJVSUxERElSKQoJQG1rZGlyIC1wICQoc2hlbGwgZGlybmFtZSAiJEAiKQoJQCQoQ0MpICQoQ0ZMQUdTKSAkKElOQykgLWMgLW8gJEAgJDwKCiNVc2VzIHNlY29uZCBleHBhbnNpb24gdG8gYWRkIHRoZSBvYmplY3QgZmlsZSBkZXBlbmRlbmNpZXMgdG8gdGhlIHRhcmdldCBydWxlCiNEb3duc2lkZTogbm8gdHdvIHRhcmdldHMgY2FuIGhhdmUgc2FtZSBuYW1lIHJlZ2FyZGxlc3Mgb2YgdGFyZ2V0IGRpcmVjdG9yeQouU0VDT05ERVhQQU5TSU9OOgokKFRBUkdFVERJUikvJTogJCQoJCQqX09CSkVDVFMpCglAZWNobyAiTGlua2luZyAkQCIKCUBta2RpciAtcCAkKHNoZWxsIGRpcm5hbWUgIiRAIikKCUAkKENDKSAkXiAtbyAkQCAkKExJQikKCiNDbGVhcnMgb3V0IHRoZSB0YXJnZXQgYW5kIGJ1aWxkaW5nIGRpcmVjdG9yaWVzCmNsZWFuOgoJQGVjaG8gUmVtb3ZpbmcgZ2VuZXJhdGVkIGZpbGVzCglAcm0gLXIgJChCVUlMRERJUikgJChUQVJHRVRESVIpCgouUEhPTlk6IGNsZWFuCg==

rm -f Makefile
touch Makefile
echo $FIRST | base64 -d >> Makefile

TARGETS="TARGETS := "
OBJDEP=""

while IFS='' read -r line || [[ -n "$line" ]]; do
      I=`expr index "$line" ":"`
      T="${line:0:I-1}"
      D='$(BUILDDIR)/'"${line:I}"
      
      TARGETS="${TARGETS}"'$(TARGETDIR)/'"${T} "
      OBJDEP="${OBJDEP}${T}_OBJECTS := ${D}"$'\n'
      
done < Targets

echo "$TARGETS" >> Makefile
echo "" >> Makefile
echo "$OBJDEP" >> Makefile

echo $SECOND | base64 -d >> Makefile